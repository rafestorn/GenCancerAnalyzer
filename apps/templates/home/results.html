{% extends 'layouts/base.html' %}

{% block title %} Dashboard {% endblock title %}

{% block stylesheets %}
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.css" />
  
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.js"></script>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

{% endblock stylesheets %}

{% block content %}

    <h1>Datos del análisis de expresión diferencial</h1>
    <div id="datatableContainer" style="display: none; width: 80%;">
        <table id="miTabla" class="table table-bordered">
            <thead>
                <tr>
                    <th>Identifier</th>
                    <th>Symbol</th>
                    <th>Group</th>
                    <th>BaseMean</th>
                    <th>LogFC</th>
                    <th>LfcSE</th>
                    <th>Stat</th>
                    <th>PValue</th>
                    <th>FDR</th>
                </tr>
            </thead>
            <tbody>
                {% for record in data %}
                <tr>
                    <td>{{ record.Id }}</td>
                    <td>{{ record.symbol}}</td>
                    <td>{{ record.group}}</td>
                    <td>{{ record.baseMean}}</td>
                    <td>{{ record.logFC}}</td>
                    <td>{{ record.lfcSE}}</td>
                    <td>{{ record.stat}}</td>
                    <td>{{ record.PValue}}</td>
                    <td>{{ record.FDR}}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <h1>Volcano Plot</h1>
    {{ volcano_plot | safe }}

    <h1>BarPlot</h1>
    {{ bar_plot | safe }}

    <h1>Correlation Plot</h1>
    {{ corr_plot | safe }}

    <h1>Functional Enrichment Analysis</h1>
    <div id="myHorizontalBarChart"></div>

{% endblock content %}

{% block javascripts %}
<script>
$(document).ready( function () {
    $('#miTabla').DataTable({
        scrollX: true,
    });
    $('#datatableContainer').show();
} );
// document.addEventListener("DOMContentLoaded", function() {
//     var contextData = {{ enrichData | safe }};
//     var Dict = {};
//     contextData.forEach(entry => {
//         Dict[entry.Terms] = -Math.log10(entry.FDR);
//     });
    
//     var trace = {
//         x: Object.keys(Dict),
//         y: Object.values(Dict),
//         type: 'bar',
//         orientation: 'h'
//     };
    
//     var layout = {
//         title: 'Horizontal Bar Chart'
//     };
    
//     var plotData = [trace];
    
//     Plotly.newPlot('myHorizontalBarChart', plotData, layout);
// });

</script>

{% endblock javascripts %}